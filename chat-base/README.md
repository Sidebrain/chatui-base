# React + TypeScript + Vite

## Learnings

Getting storybook to work with vite, shad-cn and tailwind was painful to say the least.

Here are the problems in getting it to work:

-   shadcn uses tailwind directives, which means that the css file is generated by vite on the fly to enable hot module reloading.
-   the on the fly generated css is then injected into the html to reflect any updates
-   storybook on the other hand needs to be pointed to a css file for it to work

## Potential solutions

1. do an `npm run build` everytime because this will generate a css file and put it into dist. However, that is inconvenient and I wont be able to take advantage of the hot module reloading. So no go
2. You can use `npx tailwindcss -i ./src/input.css -o ./src/output.css --watch` to generate a tailwind css file, and have `chokidar` to watch for changes in directory and when it does detect a change get the tailwind command to run. Ideally get both to run the same time when `npm run dev` is retriggered

## Final solve

1. Add the following to the package.json file

```json
{
    //...
    "scripts": {
        "dev": "npm-run-all --parallel vite watch:css",
        "build:css": "tailwindcss -i ./src/index.css -o ./public/output.css --minify",
        "watch:css": "chokidar 'src/**/*.{html,ts,tsx,css}' -c 'npm run build:css'",
        "vite": "vite"
        //...
    },
    "dependencies": {
        //...
    },
    "devDependencies": {
        //.....
        "npm-run-all": "^4.1.5"
    }
}
```

2. Add `import "../public/output.css";` to the `.storybook/preview.js`
3. Remove `"@storybook/addon-styling-webpack",` from `.storybook/main.ts`
